#!/usr/bin/env ruby

bed_file = ARGV[0]
gtf_file = ARGV[1]
gtf_handle = File.open(gtf_file,'w')
origin = "SIM1_PLUS"
coding = "CDS"
exon = "exon"

File.open(bed_file).each do |line|
  line.chomp!
  info = line.split("\t")
  chr = info[0]
  starts = info[5].split(",")
  ends = info[6].split(",")
  id = info[7]
  strand = info[1]
  starts.each_with_index do |start,i|
    gtf_handle.puts "#{chr}\t#{origin}\tCDS\t#{start}\t#{ends[i]}\t0.000000\t#{strand}\t.\tgene_id \"#{id}\"; transcript_id \"#{id}\""
    gtf_handle.puts "#{chr}\t#{origin}\texon\t#{start}\t#{ends[i]}\t0.000000\t#{strand}\t.\tgene_id \"#{id}\"; transcript_id \"#{id}\""
  end
  exit
end

