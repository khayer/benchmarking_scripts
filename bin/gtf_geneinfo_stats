#!/usr/bin/env ruby
require "benchmarking_scripts"
require 'optparse'

options = {}

opt_parser = OptionParser.new do |opt|
  opt.banner = "Usage: #{$0} COMMAND [OPTIONS]"
  opt.separator  ""
  opt.separator  "Commands"
  opt.separator  "     start: start server"
  opt.separator  "     stop: stop server"
  opt.separator  "     restart: restart server"
  opt.separator  ""
  opt.separator  "Options"

  opt.on("-e","--environment ENVIRONMENT","which environment you want server run") do |environment|
    options[:environment] = environment
  end

  opt.on("-d","--daemon","runing on daemon mode?") do
    options[:daemon] = true
  end

  opt.on("-h","--help","help") do
    puts opt_parser
    exit
  end
end

opt_parser.parse!

transcripts = ARGV[1]
geneinfo = ARGV[2]

case ARGV[0]
when "gff"
  if ARGV.length >= 3
    compare_obj = CompareGenesGFF.new(geneinfo,transcripts)
  else
    STDERR.puts "Please specify files"
    exit
  end
when "gtf"
  if ARGV.length >= 3
    compare_obj = CompareGenesGTF.new(geneinfo,transcripts)
  else
    STDERR.puts "Please specify files"
    exit
  end
when ""
  puts "Please pick a runmode"
  puts opt_parser
  exit
else
  puts opt_parser
  exit
end

compare_obj.compare_file.create_index()
compare_obj.geneinfo.create_index()
compare_obj.statistics()
puts (["#splice_forms"] + (0..10).to_a).join("\t")
puts "---------------------------------------------------------------------------------------------------------"
puts (["#Strong TP"] + compare_obj.strong_TP).join("\t")
puts (["# Weak TP"] + compare_obj.weak_TP).join("\t")
puts (["# All FP"] + compare_obj.all_FP).join("\t")

usage =<<EOF

      #{$0} in.gff truth_geneinfo

      ------------------------------------------------------
      * in.gff   :: produced by gmap
      ------------------------------------------------------

      Finds True Positives in gff files.

                                                   by khayer

EOF


